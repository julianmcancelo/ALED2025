<!-- Contenedor principal de la p√°gina de la tienda -->
<div class="container-custom py-8">

  <!-- Encabezado de la tienda -->
  <header class="text-center mb-12">
    @if (terminoBusqueda) {
      <!-- Encabezado para resultados de b√∫squeda -->
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6">
        <h1 class="text-3xl font-bold text-[#0077b6] mb-2">
          <i class="bi bi-search mr-2"></i>
          Resultados de B√∫squeda
        </h1>
        <p class="text-lg text-gray-700 mb-2">
          Buscando: <span class="font-semibold text-[#0077b6]">"{{ terminoBusqueda }}"</span>
        </p>
        <p class="text-sm text-gray-600">
          {{ totalProductos }} producto{{ totalProductos === 1 ? '' : 's' }} encontrado{{ totalProductos === 1 ? '' : 's' }}
        </p>
      </div>
    } @else {
      <!-- Encabezado normal de la tienda -->
      <h1 class="text-4xl font-bold text-gray-900 mb-4">Nuestros Productos</h1>
      <p class="text-xl text-gray-600 mb-2">Explora nuestro cat√°logo y encuentra lo que buscas.</p>
      <p class="text-sm text-gray-500">
        {{ totalProductos }} producto{{ totalProductos === 1 ? '' : 's' }} disponible{{ totalProductos === 1 ? '' : 's' }}
      </p>
    }
  </header>

  <!-- Usamos @if para manejar el estado del observable de productos -->
  @if (productos$ | async; as productos) {
    <!-- Si hay productos, los mostramos en una cuadr√≠cula estilo MercadoLibre -->
    @if (productos.length > 0) {
      <div class="productos-grid">

        <!-- Iteramos sobre cada producto con @for -->
        @for (producto of productos; track producto.id) {
          <div class="producto-card" (click)="verDetalles(producto)">
            <!-- Imagen del producto -->
            <div class="producto-imagen-container">
              @if (producto.imagen) {
                <img [src]="producto.imagen" 
                     class="producto-imagen" 
                     [alt]="producto.nombre"
                     (error)="onImageError($event)">
              } @else {
                <!-- Placeholder cuando no hay imagen -->
                <div class="producto-imagen-placeholder">
                  <i class="bi bi-box-seam"></i>
                  <span>Sin imagen</span>
                </div>
              }
              
              <!-- Badge de categor√≠a -->
              <div class="categoria-badge">
                <span>{{ producto.categoria }}</span>
              </div>
              
              <!-- Overlay con bot√≥n de favoritos -->
              <div class="producto-overlay">
                <button class="favorito-btn" (click)="$event.stopPropagation()">
                  <i class="bi bi-heart"></i>
                </button>
              </div>
            </div>

            <!-- Informaci√≥n del producto -->
            <div class="producto-info">
              <!-- T√≠tulo del producto -->
              <h3 class="producto-titulo">
                {{ producto.nombre }}
              </h3>
              
              <!-- Precio -->
              <div class="producto-precio-container">
                <div class="precio-principal">
                  {{ producto.precio | currency:'ARS':'symbol':'1.0-0' }}
                </div>
                <div class="precio-cuotas">
                  en 12x {{ (producto.precio / 12) | currency:'ARS':'symbol':'1.0-0' }}
                </div>
              </div>
              
              <!-- Env√≠o -->
              <div class="envio-info">
                @if (producto.precio > 50000) {
                  <span class="envio-gratis">
                    <i class="bi bi-truck"></i>
                    Env√≠o gratis
                  </span>
                } @else {
                  <span class="envio-pago">
                    <i class="bi bi-truck"></i>
                    Env√≠o $1.000
                  </span>
                }
              </div>
              
              <!-- Bot√≥n de agregar al carrito -->
              <button class="agregar-carrito-btn" 
                      (click)="agregarAlCarrito(producto); $event.stopPropagation()">
                <i class="bi bi-cart-plus"></i>
                Agregar al carrito
              </button>
            </div>
          </div>
        }
      </div>
      
      <!-- Paginaci√≥n estilo MercadoLibre -->
      <div class="paginacion-container">
        <nav class="paginacion">
          <button class="paginacion-btn paginacion-prev" disabled>
            <i class="bi bi-chevron-left"></i>
            Anterior
          </button>
          
          <div class="paginacion-numeros">
            <button class="paginacion-numero activo">1</button>
            <button class="paginacion-numero">2</button>
            <button class="paginacion-numero">3</button>
            <span class="paginacion-dots">...</span>
            <button class="paginacion-numero">10</button>
          </div>
          
          <button class="paginacion-btn paginacion-next">
            Siguiente
            <i class="bi bi-chevron-right"></i>
          </button>
        </nav>
        
        <div class="resultados-info">
          Mostrando 1-48 de {{ totalProductos }} resultados
        </div>
      </div>
    } @else {
      <!-- Mensaje que se muestra si no hay productos -->
      <div class="text-center py-12">
        @if (terminoBusqueda) {
          <!-- Mensaje espec√≠fico para b√∫squedas sin resultados -->
          <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-8 max-w-md mx-auto">
            <i class="bi bi-search text-6xl text-yellow-500 mb-4"></i>
            <h3 class="text-2xl font-semibold text-gray-900 mb-2">Sin resultados</h3>
            <p class="text-gray-600 mb-4">
              No encontramos productos que coincidan con <span class="font-semibold">"{{ terminoBusqueda }}"</span>
            </p>
            <div class="text-sm text-gray-500">
              <p class="mb-2">üí° Sugerencias:</p>
              <ul class="text-left space-y-1">
                <li>‚Ä¢ Verifica la ortograf√≠a</li>
                <li>‚Ä¢ Usa t√©rminos m√°s generales</li>
                <li>‚Ä¢ Prueba con sin√≥nimos</li>
              </ul>
            </div>
          </div>
        } @else {
          <!-- Mensaje general cuando no hay productos -->
          <i class="bi bi-emoji-frown text-6xl text-gray-400 mb-4"></i>
          <h3 class="text-2xl font-semibold text-gray-900 mb-2">No hay productos disponibles</h3>
          <p class="text-gray-600">Vuelve a intentarlo m√°s tarde.</p>
        }
      </div>
    }
  } @else {
    <!-- Indicador de carga que se muestra mientras se obtienen los datos -->
      <div class="text-center py-12">
        <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-[#0077b6]"></div>
        <p class="mt-2 text-gray-600">Cargando productos...</p>
      </div>
  }
</div>
